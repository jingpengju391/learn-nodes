# 浏览器缓存

### 缓存优点

- 减少不必要的数据传输，节省宽带
- 减少服务器的负担，提升网站性能
- 加快客户端加载速度
- 用户体验友好

### 缺点

- 资源如果更改但是客户单不及时更新会造成用户获取信息滞后

### 强制缓存

##### 	如果资源没有过期就走强制缓存，否则请求服务器

##### 	资源是否过期

- response headers 中的 Cache-Control 值：

  - private：仅浏览器可以缓存
  - public：浏览器和代理服务器都可以缓存
  - max-age=xxx 过期时间
  - no-catch：不进行强制缓存，走协商缓存
  - no-store：不强制缓存，不协商缓存
  - immutable：表示资源永远不变，主要用于刷新时不请求资源，走缓存

  规则可以多个

#### 协商缓存

- Cache-Control 设置 no-catch
- max-age 过期

###### 	以上情况都会走协商缓存，除no-store外一般都会走协商缓存

- 过期标识两个： etag（ hash 每个文件都有自己的etag ），last-modified 文件修改的时间
- 每次请求资源时，浏览器的请求头上都会带着 etag、last-modified，服务器进行对比，没有过期返回304走协商缓存，否则返回新资源
- 发请求 --> 资源是否过期 --> 过期 --> 请求服务器 --> 服务器进行资源对比 --> 没过期 --> 返回304状态码 --> 客户端用缓存老资源

#### 什么时候用强制缓存，什么时候用协商缓存

- html页面走协商缓存，保证每次用户拿到的都是最新的，其他的资源走强制缓存+协商缓存

